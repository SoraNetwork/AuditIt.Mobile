import{d as W,r as i,C as j,o as z,A as G,B as Q,a as N,m as n,e as a,f as s,w as t,D as q,i as J,F as K,E as X,l as r,b as y,k as Y,p as Z,g as ee,G as c,j as d}from"./index-DFPY2jgj.js";import{u as te}from"./itemStore-D-tZNvqK.js";import{u as oe}from"./warehouseStore-BNI84oOx.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";const se={InStock:{text:"在库",color:"green"},LoanedOut:{text:"借出",color:"orange"},Disposed:{text:"处置",color:"red"}},ne={class:"page-wrapper"},le={class:"filter-controls"},re={class:"card-title"},ue={class:"item-id"},ie=W({__name:"InventoryView",setup(ce){const U=ee(),w=te(),h=oe(),_=i(!0),v=i([]),x=i([]),p=i(""),u=j({warehouseId:void 0,status:void 0}),g=i(null),I=i("400px"),V=()=>{if(g.value){const l=g.value.offsetHeight,e=60;I.value=`calc(100vh - ${l}px - ${e}px)`}},k=l=>se[l]||{text:"未知",color:"gray"},C=async()=>{_.value=!0;try{await Promise.all([w.fetchItems({...u}),h.fetchWarehouses()]),v.value=w.items,x.value=h.warehouses}catch(l){console.error("Failed to fetch inventory data:",l),J.error("加载库存数据失败"),v.value=[]}finally{_.value=!1}};z(async()=>{await C(),await G(),V()});const B=Q(()=>{const l=v.value.map(e=>({...e,name:e.itemDefinition?.name||"未知物品",warehouseName:e.warehouse?.name||"未知仓库"}));if(p.value){const e=p.value.toLowerCase();return l.filter(m=>m.name.toLowerCase().includes(e)||m.shortId.toLowerCase().includes(e))}return l}),D=()=>{C()};return(l,e)=>{const m=s("a-page-header"),f=s("a-select-option"),b=s("a-select"),S=s("a-form-item"),L=s("a-col"),H=s("a-row"),T=s("a-form"),F=s("a-input-search"),A=s("a-tag"),R=s("a-card"),$=s("router-link"),E=s("a-list-item"),M=s("a-button"),O=s("a-empty"),P=s("a-list");return d(),N("div",ne,[n("div",{class:"fixed-content",ref_key:"fixedContentRef",ref:g},[a(m,{title:"库存总览","show-back":!1}),n("div",le,[a(T,{layout:"vertical",model:u},{default:t(()=>[a(H,{gutter:16},{default:t(()=>[a(L,{span:12},{default:t(()=>[a(S,null,{default:t(()=>[a(b,{value:u.warehouseId,"onUpdate:value":e[0]||(e[0]=o=>u.warehouseId=o),placeholder:"所有仓库","allow-clear":"",onChange:D},{default:t(()=>[(d(!0),N(K,null,X(x.value,o=>(d(),y(f,{key:o.id,value:o.id},{default:t(()=>[r(c(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),a(L,{span:12},{default:t(()=>[a(S,null,{default:t(()=>[a(b,{value:u.status,"onUpdate:value":e[1]||(e[1]=o=>u.status=o),placeholder:"所有状态","allow-clear":"",onChange:D},{default:t(()=>[a(f,{value:"InStock"},{default:t(()=>e[4]||(e[4]=[r("在库",-1)])),_:1,__:[4]}),a(f,{value:"LoanedOut"},{default:t(()=>e[5]||(e[5]=[r("借出",-1)])),_:1,__:[5]}),a(f,{value:"Disposed"},{default:t(()=>e[6]||(e[6]=[r("处置",-1)])),_:1,__:[6]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),a(F,{value:p.value,"onUpdate:value":e[2]||(e[2]=o=>p.value=o),placeholder:"通过ID或名称搜索..."},null,8,["value"])])],512),n("div",{class:"scrollable-content",style:q({height:I.value})},[a(P,{"data-source":B.value,loading:_.value,"item-layout":"vertical"},{renderItem:t(({item:o})=>[(d(),y(E,{key:o.id},{default:t(()=>[a($,{to:{name:"item-details",params:{id:o.id}}},{default:t(()=>[a(R,{hoverable:""},{title:t(()=>[n("span",re,c(o.name),1)]),extra:t(()=>[a(A,{color:k(o.status).color},{default:t(()=>[r(c(k(o.status).text),1)]),_:2},1032,["color"])]),default:t(()=>[n("p",null,[e[7]||(e[7]=n("strong",null,"可视化ID:",-1)),r(" "+c(o.shortId),1)]),n("p",null,[e[8]||(e[8]=n("strong",null,"所在仓库:",-1)),r(" "+c(o.warehouseName),1)]),n("p",ue,[e[9]||(e[9]=n("strong",null,"UUID:",-1)),r(" "+c(o.id),1)])]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))]),empty:t(()=>[_.value?Y("",!0):(d(),y(O,{key:0,description:"没有找到物品"},{default:t(()=>[a(M,{type:"primary",onClick:e[3]||(e[3]=o=>Z(U).push("/inbound"))},{default:t(()=>e[10]||(e[10]=[r("立即入库",-1)])),_:1,__:[10]})]),_:1}))]),_:1},8,["data-source","loading"])],4)])}}}),fe=ae(ie,[["__scopeId","data-v-78b8c44d"]]);export{fe as default};
