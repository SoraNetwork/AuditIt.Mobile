import{d as F,C as h,r as M,B as W,o as j,b as g,f as t,p as u,q as d,i as q,g as a,h as n,F as z,E as G,D as L,G as I,l as m,e as O,n as R}from"./index-BqQ9Dcin.js";import{u as T}from"./warehouseStore-AICgy_g_.js";import{u as $}from"./itemStore-CIYP7r49.js";import{u as A}from"./itemDefinitionStore-F_TNFLsC.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"page-container"},K={class:"input-area"},P=F({__name:"Check",setup(X){const k=q(),p=T(),c=$(),f=A(),i=h({warehouseId:void 0}),_=M([]),D=W(()=>f.itemDefinitions.reduce((r,e)=>(r[e.id]=e,r),{}));j(()=>{p.fetchWarehouses(),f.fetchItemDefinitions()});const w=async()=>{if(!i.warehouseId){_.value=[];return}await c.fetchItems(i.warehouseId);const r=c.items.reduce((e,s)=>(e[s.itemDefinitionId]=(e[s.itemDefinitionId]||0)+1,e),{});_.value=Object.keys(r).map(e=>{const s=r[e];return h({itemDefinitionId:e,name:D.value[e]?.name||"未知物品",bookedQuantity:s,actualQuantity:s,get difference(){return this.actualQuantity-this.bookedQuantity}})})};return(r,e)=>{const s=a("a-page-header"),b=a("a-select-option"),S=a("a-select"),C=a("a-form-item"),Q=a("a-form"),v=a("a-statistic"),y=a("a-col"),x=a("a-row"),B=a("a-divider"),N=a("a-input-number"),U=a("a-card"),V=a("a-list-item"),E=a("a-list");return m(),g("div",null,[t(s,{title:"库存盘点",onBack:e[0]||(e[0]=o=>d(k).back())}),u("div",J,[t(Q,{layout:"vertical",model:i},{default:n(()=>[t(C,{label:"选择仓库"},{default:n(()=>[t(S,{value:i.warehouseId,"onUpdate:value":e[1]||(e[1]=o=>i.warehouseId=o),placeholder:"请选择仓库",onChange:w,"allow-clear":""},{default:n(()=>[(m(!0),g(z,null,G(d(p).warehouses,o=>(m(),O(b,{key:o.id,value:o.id},{default:n(()=>[R(I(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"]),t(E,{"data-source":_.value,loading:d(c).loading,"item-layout":"vertical"},{renderItem:n(({item:o})=>[t(V,null,{default:n(()=>[t(U,{title:o.name},{default:n(()=>[t(x,{gutter:16},{default:n(()=>[t(y,{span:12},{default:n(()=>[t(v,{title:"账面数量",value:o.bookedQuantity},null,8,["value"])]),_:2},1024),t(y,{span:12},{default:n(()=>[t(v,{title:"差异",value:o.difference},{formatter:n(({value:l})=>[u("span",{style:L({color:l!==0?"#ff4d4f":"#52c41a"})},I(l),5)]),_:2},1032,["value"])]),_:2},1024)]),_:2},1024),t(B,{style:{margin:"12px 0"}}),u("div",K,[e[2]||(e[2]=u("span",null,"实盘数量:",-1)),t(N,{value:o.actualQuantity,"onUpdate:value":l=>o.actualQuantity=l,min:0},null,8,["value","onUpdate:value"])])]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),oe=H(P,[["__scopeId","data-v-9744dfa3"]]);export{oe as default};
