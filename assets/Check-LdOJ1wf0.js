import{d as E,C as g,r as F,B as M,o as W,a as h,e as t,m as u,p as d,g as z,f as a,w as n,F as G,E as L,D as O,G as I,j as m,b as R,l as T}from"./index-DYVI02XC.js";import{u as $}from"./warehouseStore-FqhuKAxs.js";import{u as q}from"./itemStore-CQDUPuNC.js";import{u as A}from"./itemDefinitionStore-BUnL8nbs.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./v4-BKrj-4V8.js";const J={class:"page-container"},K={class:"input-area"},P=E({__name:"Check",setup(X){const k=z(),p=$(),c=q(),f=A(),i=g({warehouseId:void 0}),_=F([]),w=M(()=>f.itemDefinitions.reduce((r,e)=>(r[e.id]=e,r),{}));W(()=>{p.fetchWarehouses(),f.fetchItemDefinitions()});const D=async()=>{if(!i.warehouseId){_.value=[];return}await c.fetchItems(i.warehouseId);const r=c.items.reduce((e,s)=>(e[s.itemDefinitionId]=(e[s.itemDefinitionId]||0)+1,e),{});_.value=Object.keys(r).map(e=>{const s=r[e];return g({itemDefinitionId:e,name:w.value[e]?.name||"未知物品",bookedQuantity:s,actualQuantity:s,get difference(){return this.actualQuantity-this.bookedQuantity}})})};return(r,e)=>{const s=a("a-page-header"),b=a("a-select-option"),S=a("a-select"),C=a("a-form-item"),Q=a("a-form"),v=a("a-statistic"),y=a("a-col"),x=a("a-row"),B=a("a-divider"),N=a("a-input-number"),U=a("a-card"),V=a("a-list-item"),j=a("a-list");return m(),h("div",null,[t(s,{title:"库存盘点",onBack:e[0]||(e[0]=o=>d(k).back())}),u("div",J,[t(Q,{layout:"vertical",model:i},{default:n(()=>[t(C,{label:"选择仓库"},{default:n(()=>[t(S,{value:i.warehouseId,"onUpdate:value":e[1]||(e[1]=o=>i.warehouseId=o),placeholder:"请选择仓库",onChange:D,"allow-clear":""},{default:n(()=>[(m(!0),h(G,null,L(d(p).warehouses,o=>(m(),R(b,{key:o.id,value:o.id},{default:n(()=>[T(I(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"]),t(j,{"data-source":_.value,loading:d(c).loading,"item-layout":"vertical"},{renderItem:n(({item:o})=>[t(V,null,{default:n(()=>[t(U,{title:o.name},{default:n(()=>[t(x,{gutter:16},{default:n(()=>[t(y,{span:12},{default:n(()=>[t(v,{title:"账面数量",value:o.bookedQuantity},null,8,["value"])]),_:2},1024),t(y,{span:12},{default:n(()=>[t(v,{title:"差异",value:o.difference},{formatter:n(({value:l})=>[u("span",{style:O({color:l!==0?"#ff4d4f":"#52c41a"})},I(l),5)]),_:2},1032,["value"])]),_:2},1024)]),_:2},1024),t(B,{style:{margin:"12px 0"}}),u("div",K,[e[2]||(e[2]=u("span",null,"实盘数量:",-1)),t(N,{value:o.actualQuantity,"onUpdate:value":l=>o.actualQuantity=l,min:0},null,8,["value","onUpdate:value"])])]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),ne=H(P,[["__scopeId","data-v-9744dfa3"]]);export{ne as default};
