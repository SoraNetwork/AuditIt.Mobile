import{d as F,A as h,r as M,z as W,o as j,c as g,e as t,h as u,l as d,a as A,f as a,w as n,F as E,B as L,P as O,t as k,g as m,k as P,C as R}from"./index-CddxdGKo.js";import{u as T}from"./warehouseStore-Cfivk1GD.js";import{u as $}from"./itemStore-DS5NscXt.js";import{u as q}from"./itemDefinitionStore-ec9Uvj7-.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"page-container"},J={class:"input-area"},K=F({__name:"Check",setup(X){const I=A(),p=T(),c=$(),f=q(),i=h({warehouseId:void 0}),_=M([]),w=W(()=>f.itemDefinitions.reduce((r,e)=>(r[e.id]=e,r),{}));j(()=>{p.fetchWarehouses(),f.fetchItemDefinitions()});const D=async()=>{if(!i.warehouseId){_.value=[];return}await c.fetchItems(i.warehouseId);const r=c.items.reduce((e,s)=>(e[s.itemDefinitionId]=(e[s.itemDefinitionId]||0)+1,e),{});_.value=Object.keys(r).map(e=>{const s=r[e];return h({itemDefinitionId:e,name:w.value[e]?.name||"未知物品",bookedQuantity:s,actualQuantity:s,get difference(){return this.actualQuantity-this.bookedQuantity}})})};return(r,e)=>{const s=a("a-page-header"),S=a("a-select-option"),b=a("a-select"),C=a("a-form-item"),Q=a("a-form"),v=a("a-statistic"),y=a("a-col"),x=a("a-row"),B=a("a-divider"),N=a("a-input-number"),U=a("a-card"),V=a("a-list-item"),z=a("a-list");return m(),g("div",null,[t(s,{title:"库存盘点",onBack:e[0]||(e[0]=o=>d(I).back())}),u("div",H,[t(Q,{layout:"vertical",model:i},{default:n(()=>[t(C,{label:"选择仓库"},{default:n(()=>[t(b,{value:i.warehouseId,"onUpdate:value":e[1]||(e[1]=o=>i.warehouseId=o),placeholder:"请选择仓库",onChange:D,"allow-clear":""},{default:n(()=>[(m(!0),g(E,null,L(d(p).warehouses,o=>(m(),P(S,{key:o.id,value:o.id},{default:n(()=>[R(k(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"]),t(z,{"data-source":_.value,loading:d(c).loading,"item-layout":"vertical"},{renderItem:n(({item:o})=>[t(V,null,{default:n(()=>[t(U,{title:o.name},{default:n(()=>[t(x,{gutter:16},{default:n(()=>[t(y,{span:12},{default:n(()=>[t(v,{title:"账面数量",value:o.bookedQuantity},null,8,["value"])]),_:2},1024),t(y,{span:12},{default:n(()=>[t(v,{title:"差异",value:o.difference},{formatter:n(({value:l})=>[u("span",{style:O({color:l!==0?"#ff4d4f":"#52c41a"})},k(l),5)]),_:2},1032,["value"])]),_:2},1024)]),_:2},1024),t(B,{style:{margin:"12px 0"}}),u("div",J,[e[2]||(e[2]=u("span",null,"实盘数量:",-1)),t(N,{value:o.actualQuantity,"onUpdate:value":l=>o.actualQuantity=l,min:0},null,8,["value","onUpdate:value"])])]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),oe=G(K,[["__scopeId","data-v-9744dfa3"]]);export{oe as default};
