import{d as B,B as p,o as V,a as _,e as o,m as i,w as a,f as s,p as d,l,k as E,G as u,H as T,J as L,g as M,i as f,j as g}from"./index-BIP7TFCp.js";import{u as O}from"./itemDefinitionStore-BmGfWbLf.js";import{u as $}from"./categoryStore-CtxObPfD.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"list-container"},A={key:0},G=B({__name:"ItemDefinitionList",setup(H){const m=M(),r=O(),c=$(),y=p(()=>c.categories.reduce((t,e)=>(t[e.id]=e.name,t),{})),k=p(()=>r.itemDefinitions.map(t=>({...t,categoryName:y.value[t.categoryId]||"N/A"}))),C=()=>{m.push({name:"item-definition-new"})},D=t=>{m.push({name:"item-definition-edit",params:{id:t.toString()}})},x=async t=>{try{await r.deleteItemDefinition(t),f.success("物品定义删除成功")}catch{f.error("删除物品定义失败")}};return V(()=>{r.fetchItemDefinitions(),c.categories.length===0&&c.fetchCategories()}),(t,e)=>{const h=s("a-button"),v=s("a-page-header"),I=s("a-popconfirm"),N=s("a-card"),w=s("a-list-item"),S=s("a-list");return g(),_("div",null,[o(v,{title:"物品定义","show-back":!1},{extra:a(()=>[o(h,{key:"1",type:"primary",onClick:C},{default:a(()=>e[0]||(e[0]=[l("添加",-1)])),_:1,__:[0]})]),_:1}),i("div",z,[o(S,{"item-layout":"horizontal","data-source":k.value,loading:d(r).loading,grid:{gutter:16,xs:1,sm:1,md:2}},{renderItem:a(({item:n})=>[o(w,null,{default:a(()=>[o(N,{title:n.name,style:{width:"100%"}},{actions:a(()=>[o(d(T),{key:"edit",onClick:b=>D(n.id)},null,8,["onClick"]),o(I,{title:"您确定要删除这个物品定义吗？",onConfirm:b=>x(n.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[o(d(L),{key:"delete",style:{color:"red"}})]),_:2},1032,["onConfirm"])]),default:a(()=>[i("p",null,[e[1]||(e[1]=i("strong",null,"分类:",-1)),l(" "+u(n.categoryName),1)]),i("p",null,[e[2]||(e[2]=i("strong",null,"单位:",-1)),l(" "+u(n.unit),1)]),n.description?(g(),_("p",A,[e[3]||(e[3]=i("strong",null,"描述:",-1)),l(" "+u(n.description),1)])):E("",!0)]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),K=j(G,[["__scopeId","data-v-1dd1e540"]]);export{K as default};
