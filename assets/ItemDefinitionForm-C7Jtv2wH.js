import{d as R,r as v,C as U,B as q,o as V,h as j,a as y,e as t,m as E,f as s,w as n,p,F as T,D as L,l as b,g as M,j as f,b as O,E as z,i as _}from"./index-B7yYOxnO.js";import{u as A}from"./itemDefinitionStore-0Vcju05k.js";import{u as G}from"./categoryStore-B-HBoUWY.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"form-container"},K=R({__name:"ItemDefinitionForm",setup(P){const I=j(),g=M(),l=A(),u=G(),k=v(),o=U({name:"",categoryId:void 0,unit:"",description:""}),c=v(null),D=q(()=>c.value?"编辑物品定义":"添加物品定义"),x={name:[{required:!0,message:"请输入物品名称！"}],categoryId:[{required:!0,message:"请选择一个分类！"}],unit:[{required:!0,message:"请输入单位！"}]};V(()=>{u.categories.length===0&&u.fetchCategories();const r=I.params.id;if(r&&typeof r=="string"){c.value=r;const e=Number(r),d=l.itemDefinitions.find(m=>m.id===e);d&&Object.assign(o,d)}});const B=async r=>{try{c.value?(await l.updateItemDefinition({id:Number(c.value),...r}),_.success("物品定义更新成功")):(await l.addItemDefinition(r),_.success("物品定义添加成功")),g.back()}catch{_.error("保存失败")}},C=()=>{g.back()};return(r,e)=>{const d=s("a-page-header"),m=s("a-input"),i=s("a-form-item"),S=s("a-select-option"),h=s("a-select"),F=s("a-textarea"),N=s("a-button"),w=s("a-form");return f(),y("div",null,[t(d,{title:D.value,onBack:C},null,8,["title"]),E("div",J,[t(w,{ref_key:"formRef",ref:k,model:o,rules:x,layout:"vertical",onFinish:B},{default:n(()=>[t(i,{label:"物品名称",name:"name"},{default:n(()=>[t(m,{value:o.name,"onUpdate:value":e[0]||(e[0]=a=>o.name=a),placeholder:"请输入物品名称"},null,8,["value"])]),_:1}),t(i,{label:"分类",name:"categoryId"},{default:n(()=>[t(h,{value:o.categoryId,"onUpdate:value":e[1]||(e[1]=a=>o.categoryId=a),placeholder:"请选择一个分类",loading:p(u).loading},{default:n(()=>[(f(!0),y(T,null,L(p(u).categories,a=>(f(),O(S,{key:a.id,value:a.id},{default:n(()=>[b(z(a.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","loading"])]),_:1}),t(i,{label:"单位",name:"unit"},{default:n(()=>[t(m,{value:o.unit,"onUpdate:value":e[2]||(e[2]=a=>o.unit=a),placeholder:"例如: 个, 箱, 千克"},null,8,["value"])]),_:1}),t(i,{label:"描述",name:"description"},{default:n(()=>[t(F,{value:o.description,"onUpdate:value":e[3]||(e[3]=a=>o.description=a),placeholder:"请输入描述"},null,8,["value"])]),_:1}),t(i,null,{default:n(()=>[t(N,{type:"primary","html-type":"submit",loading:p(l).loading,block:""},{default:n(()=>e[4]||(e[4]=[b(" 保存 ",-1)])),_:1,__:[4]},8,["loading"])]),_:1})]),_:1},8,["model"])])])}}}),Z=H(K,[["__scopeId","data-v-40c9cb69"]]);export{Z as default};
