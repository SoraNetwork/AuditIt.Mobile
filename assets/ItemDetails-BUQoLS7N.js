import{d as N,r as P,h as V,B as z,o as E,a as p,b as v,k as O,p as f,g as R,e,f as s,m as T,w as o,l,E as n,j as c}from"./index-BN1rwhob.js";import{u as j}from"./itemStore-CNY-Ntwx.js";import{u as A}from"./auditLogStore-CB4-mnir.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={key:1,class:"loading-container"},U={key:2,class:"page-container"},q=N({__name:"ItemDetails",setup(G){const h=V(),y=R(),g=j(),u=A(),d=P(!0),m=h.params.id,t=z(()=>g.items.find(a=>a.id===m));E(async()=>{d.value=!0,u.logs=[];try{const a=t.value?Promise.resolve():g.fetchItems({id:m}),r=u.fetchLogs({itemId:m});await Promise.all([a,r])}catch(a){console.error("Failed to load item details:",a)}finally{d.value=!1}});const k=a=>{switch(a){case"InStock":return"success";case"LoanedOut":return"warning";case"Disposed":return"error";default:return"default"}},I=a=>{switch(a){case"InStock":return"在库";case"LoanedOut":return"已借出";case"Disposed":return"已处置";default:return"未知"}};return(a,r)=>{const S=s("a-page-header"),b=s("a-spin"),i=s("a-descriptions-item"),D=s("a-badge"),w=s("a-descriptions"),x=s("a-list-item-meta"),L=s("a-list-item"),B=s("a-list"),C=s("a-empty");return c(),p("div",null,[t.value?(c(),v(S,{key:0,title:t.value.itemDefinition?.name,onBack:r[0]||(r[0]=()=>f(y).back())},null,8,["title"])):O("",!0),d.value?(c(),p("div",M,[e(b,{size:"large"})])):t.value?(c(),p("div",U,[e(w,{bordered:"",column:1},{default:o(()=>[e(i,{label:"短ID"},{default:o(()=>[l(n(t.value.shortId),1)]),_:1}),e(i,{label:"状态"},{default:o(()=>[e(D,{status:k(t.value.status),text:I(t.value.status)},null,8,["status","text"])]),_:1}),e(i,{label:"仓库"},{default:o(()=>[l(n(t.value.warehouse?.name),1)]),_:1}),e(i,{label:"入库日期"},{default:o(()=>[l(n(new Date(t.value.entryDate).toLocaleString()),1)]),_:1}),e(i,{label:"最后更新"},{default:o(()=>[l(n(new Date(t.value.lastUpdated).toLocaleString()),1)]),_:1})]),_:1}),r[1]||(r[1]=T("h3",{style:{"margin-top":"24px"}},"操作历史",-1)),e(B,{loading:f(u).loading,"data-source":f(u).logs,size:"small"},{renderItem:o(({item:_})=>[e(L,null,{default:o(()=>[e(x,null,{title:o(()=>[l(n(_.action)+" - by "+n(_.user),1)]),description:o(()=>[l(n(new Date(_.timestamp).toLocaleString()),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["loading","data-source"])])):(c(),v(C,{key:3}))])}}}),W=F(q,[["__scopeId","data-v-7a55e200"]]);export{W as default};
