import{e as t,I as j,d as F,r as P,A as $,z,R as h,o as D,c as L,h as _,l as v,a as U,f as r,w as o,C as d,i as E,t as c,g as k}from"./index-CddxdGKo.js";import{u as H}from"./auditLogStore-BF5hOTbF.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";var q={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};function C(u){for(var s=1;s<arguments.length;s++){var l=arguments[s]!=null?Object(arguments[s]):{},i=Object.keys(l);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(l).filter(function(a){return Object.getOwnPropertyDescriptor(l,a).enumerable}))),i.forEach(function(a){G(u,a,l[a])})}return u}function G(u,s,l){return s in u?Object.defineProperty(u,s,{value:l,enumerable:!0,configurable:!0,writable:!0}):u[s]=l,u}var y=function(s,l){var i=C({},s,l.attrs);return t(j,C({},i,{icon:q}),null)};y.displayName="FilterOutlined";y.inheritAttrs=!1;const J={class:"page-container"},Q={class:"log-meta"},W={class:"log-meta"},X={key:0,style:{"text-align":"center","margin-top":"16px"}},Y=F({__name:"AuditLogView",setup(u){const s=U(),l=H(),i=P(!1),a=$({dateRange:null,action:void 0,user:""}),O=z(()=>l.logs.filter(p=>{const e=h(p.timestamp),g=!a.dateRange||e.isAfter(a.dateRange[0].startOf("day"))&&e.isBefore(a.dateRange[1].endOf("day")),m=!a.action||p.action===a.action,b=!a.user||p.user.toLowerCase().includes(a.user.toLowerCase());return g&&m&&b}));return D(()=>{l.fetchLogs()}),(p,e)=>{const g=r("a-page-header"),m=r("a-button"),b=r("router-link"),x=r("a-card"),V=r("a-list-item"),R=r("a-empty"),M=r("a-list"),S=r("a-range-picker"),w=r("a-form-item"),f=r("a-select-option"),A=r("a-select"),B=r("a-input"),I=r("a-form"),N=r("a-drawer");return k(),L("div",null,[t(g,{title:"审计日志",onBack:e[0]||(e[0]=n=>v(s).back())}),_("div",J,[t(m,{block:"",onClick:e[1]||(e[1]=n=>i.value=!0),style:{"margin-bottom":"16px"}},{icon:o(()=>[t(v(y))]),default:o(()=>[e[7]||(e[7]=d(" 筛选日志 ",-1))]),_:1,__:[7]}),t(M,{"data-source":O.value,loading:v(l).loading,"item-layout":"vertical"},{renderItem:o(({item:n})=>[t(V,null,{default:o(()=>[t(x,null,{default:o(()=>[_("p",null,[_("strong",null,c(n.action),1),e[8]||(e[8]=d(" - ",-1)),t(b,{to:{name:"item-details",params:{id:n.itemId}}},{default:o(()=>[d(c(n.itemShortId),1)]),_:2},1032,["to"])]),_("p",Q,c(n.timestamp),1),_("p",W,"操作人: "+c(n.user)+" | 仓库: "+c(n.warehouseName),1)]),_:2},1024)]),_:2},1024)]),loadMore:o(()=>[!v(l).loading&&O.value.length===0?(k(),L("div",X,[t(R,{description:"没有找到符合条件的日志"})])):E("",!0)]),_:1},8,["data-source","loading"]),t(N,{title:"筛选日志",width:"90%",open:i.value,onClose:e[6]||(e[6]=n=>i.value=!1)},{footer:o(()=>[t(m,{onClick:e[5]||(e[5]=n=>i.value=!1)},{default:o(()=>e[13]||(e[13]=[d("关闭",-1)])),_:1,__:[13]})]),default:o(()=>[t(I,{layout:"vertical",model:a},{default:o(()=>[t(w,{label:"日期范围"},{default:o(()=>[t(S,{value:a.dateRange,"onUpdate:value":e[2]||(e[2]=n=>a.dateRange=n),style:{width:"100%"}},null,8,["value"])]),_:1}),t(w,{label:"操作类型"},{default:o(()=>[t(A,{value:a.action,"onUpdate:value":e[3]||(e[3]=n=>a.action=n),placeholder:"所有类型","allow-clear":""},{default:o(()=>[t(f,{value:"入库"},{default:o(()=>e[9]||(e[9]=[d("入库",-1)])),_:1,__:[9]}),t(f,{value:"借出"},{default:o(()=>e[10]||(e[10]=[d("借出",-1)])),_:1,__:[10]}),t(f,{value:"处置"},{default:o(()=>e[11]||(e[11]=[d("处置",-1)])),_:1,__:[11]}),t(f,{value:"归还"},{default:o(()=>e[12]||(e[12]=[d("归还",-1)])),_:1,__:[12]})]),_:1},8,["value"])]),_:1}),t(w,{label:"操作人"},{default:o(()=>[t(B,{value:a.user,"onUpdate:value":e[4]||(e[4]=n=>a.user=n),placeholder:"输入用户名","allow-clear":""},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open"])])])}}}),te=T(Y,[["__scopeId","data-v-b9577486"]]);export{te as default};
