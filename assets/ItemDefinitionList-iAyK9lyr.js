import{d as E,z as p,o as V,c as _,e as o,h as i,w as a,f as s,l as d,C as l,i as B,t as u,E as T,D as z,a as L,b as f,g}from"./index-CddxdGKo.js";import{u as M}from"./itemDefinitionStore-ec9Uvj7-.js";import{u as O}from"./categoryStore-D_9Faff2.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const A={class:"list-container"},R={key:0},j=E({__name:"ItemDefinitionList",setup(q){const m=L(),r=M(),c=O(),y=p(()=>c.categories.reduce((t,e)=>(t[e.id]=e.name,t),{})),C=p(()=>r.itemDefinitions.map(t=>({...t,categoryName:y.value[t.categoryId]||"N/A"}))),D=()=>{m.push({name:"item-definition-new"})},k=t=>{m.push({name:"item-definition-edit",params:{id:t.toString()}})},h=async t=>{try{await r.deleteItemDefinition(t),f.success("物品定义删除成功")}catch{f.error("删除物品定义失败")}};return V(()=>{r.fetchItemDefinitions(),c.categories.length===0&&c.fetchCategories()}),(t,e)=>{const x=s("a-button"),v=s("a-page-header"),I=s("a-popconfirm"),N=s("a-card"),w=s("a-list-item"),S=s("a-list");return g(),_("div",null,[o(v,{title:"物品定义","show-back":!1},{extra:a(()=>[o(x,{key:"1",type:"primary",onClick:D},{default:a(()=>e[0]||(e[0]=[l("添加",-1)])),_:1,__:[0]})]),_:1}),i("div",A,[o(S,{"item-layout":"horizontal","data-source":C.value,loading:d(r).loading,grid:{gutter:16,xs:1,sm:1,md:2}},{renderItem:a(({item:n})=>[o(w,null,{default:a(()=>[o(N,{title:n.name,style:{width:"100%"}},{actions:a(()=>[o(d(T),{key:"edit",onClick:b=>k(n.id)},null,8,["onClick"]),o(I,{title:"您确定要删除这个物品定义吗？",onConfirm:b=>h(n.id),"ok-text":"确定","cancel-text":"取消"},{default:a(()=>[o(d(z),{key:"delete",style:{color:"red"}})]),_:2},1032,["onConfirm"])]),default:a(()=>[i("p",null,[e[1]||(e[1]=i("strong",null,"分类:",-1)),l(" "+u(n.categoryName),1)]),i("p",null,[e[2]||(e[2]=i("strong",null,"单位:",-1)),l(" "+u(n.unit),1)]),n.description?(g(),_("p",R,[e[3]||(e[3]=i("strong",null,"描述:",-1)),l(" "+u(n.description),1)])):B("",!0)]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),K=$(j,[["__scopeId","data-v-1dd1e540"]]);export{K as default};
