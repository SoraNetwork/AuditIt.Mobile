import{d as N,r as V,h as z,B as E,o as O,a as _,b as v,k as R,p,g as T,e,f as s,m as j,w as a,l as r,E as o,j as l}from"./index-CFplA3xo.js";import{u as A}from"./itemStore-YWdOxysp.js";import{u as M}from"./auditLogStore-Bsah1iUS.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={key:1,class:"loading-container"},F={key:2,class:"page-container"},G=N({__name:"ItemDetails",setup(H){const b=z(),k=T(),f=A(),u=M(),g=V(!0),d=b.params.id,t=E(()=>f.items.find(n=>n.id===d));O(async()=>{t.value||await f.fetchItems({id:d}),await u.fetchLogs({itemId:d}),g.value=!1});const S=n=>{switch(n){case"InStock":return"success";case"LoanedOut":return"warning";case"Disposed":return"error";default:return"default"}},w=n=>{switch(n){case"InStock":return"在库";case"LoanedOut":return"已借出";case"Disposed":return"已处置";default:return"未知"}};return(n,c)=>{const y=s("a-page-header"),D=s("a-spin"),i=s("a-descriptions-item"),I=s("a-badge"),h=s("a-descriptions"),x=s("a-list-item-meta"),L=s("a-list-item"),B=s("a-list"),C=s("a-empty");return l(),_("div",null,[t.value?(l(),v(y,{key:0,title:t.value.itemDefinition?.name,onBack:c[0]||(c[0]=()=>p(k).back())},null,8,["title"])):R("",!0),g.value?(l(),_("div",q,[e(D,{size:"large"})])):t.value?(l(),_("div",F,[e(h,{bordered:"",column:1},{default:a(()=>[e(i,{label:"短ID"},{default:a(()=>[r(o(t.value.shortId),1)]),_:1}),e(i,{label:"状态"},{default:a(()=>[e(I,{status:S(t.value.status),text:w(t.value.status)},null,8,["status","text"])]),_:1}),e(i,{label:"仓库"},{default:a(()=>[r(o(t.value.warehouse?.name),1)]),_:1}),e(i,{label:"入库日期"},{default:a(()=>[r(o(new Date(t.value.entryDate).toLocaleString()),1)]),_:1}),e(i,{label:"最后更新"},{default:a(()=>[r(o(new Date(t.value.lastUpdated).toLocaleString()),1)]),_:1})]),_:1}),c[1]||(c[1]=j("h3",{style:{"margin-top":"24px"}},"操作历史",-1)),e(B,{loading:p(u).loading,"data-source":p(u).logs,size:"small"},{renderItem:a(({item:m})=>[e(L,null,{default:a(()=>[e(x,null,{title:a(()=>[r(o(m.action)+" - by "+o(m.user),1)]),description:a(()=>[r(o(new Date(m.timestamp).toLocaleString()),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["loading","data-source"])])):(l(),v(C,{key:3}))])}}}),W=U(G,[["__scopeId","data-v-def4ecb9"]]);export{W as default};
