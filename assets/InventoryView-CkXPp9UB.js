import{d as W,r as f,C as j,o as Q,B as R,a as L,e as a,m as n,f as s,w as t,i as $,F as q,D as z,l,b as y,k as G,p as H,g as J,E as d,j as i}from"./index-CFplA3xo.js";import{u as K}from"./itemStore-YWdOxysp.js";import{u as X}from"./warehouseStore-BGubqpKv.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={InStock:{text:"在库",color:"green"},LoanedOut:{text:"借出",color:"orange"},Disposed:{text:"处置",color:"red"}},ee={class:"page-container"},te={class:"filter-controls"},oe={class:"card-title"},ae={class:"item-id"},se=W({__name:"InventoryView",setup(ne){const b=J(),g=K(),w=X(),_=f(!0),v=f([]),I=f([]),c=f(""),u=j({warehouseId:void 0,status:void 0}),h=r=>Z[r]||{text:"未知",color:"gray"},k=async()=>{_.value=!0;try{await Promise.all([g.fetchItems({...u}),w.fetchWarehouses()]),v.value=g.items,I.value=w.warehouses}catch(r){console.error("Failed to fetch inventory data:",r),$.error("加载库存数据失败"),v.value=[]}finally{_.value=!1}};Q(()=>{k()});const N=R(()=>{const r=v.value.map(e=>({...e,name:e.itemDefinition?.name||"未知物品",warehouseName:e.warehouse?.name||"未知仓库"}));if(c.value){const e=c.value.toLowerCase();return r.filter(p=>p.name.toLowerCase().includes(e)||p.shortId.toLowerCase().includes(e))}return r}),x=()=>{k()};return(r,e)=>{const p=s("a-page-header"),m=s("a-select-option"),C=s("a-select"),D=s("a-form-item"),S=s("a-col"),U=s("a-row"),V=s("a-form"),B=s("a-input-search"),F=s("a-tag"),T=s("a-card"),A=s("router-link"),E=s("a-list-item"),M=s("a-button"),O=s("a-empty"),P=s("a-list");return i(),L("div",null,[a(p,{title:"库存总览","show-back":!1}),n("div",ee,[n("div",te,[a(V,{layout:"vertical",model:u},{default:t(()=>[a(U,{gutter:16},{default:t(()=>[a(S,{span:12},{default:t(()=>[a(D,null,{default:t(()=>[a(C,{value:u.warehouseId,"onUpdate:value":e[0]||(e[0]=o=>u.warehouseId=o),placeholder:"所有仓库","allow-clear":"",onChange:x},{default:t(()=>[(i(!0),L(q,null,z(I.value,o=>(i(),y(m,{key:o.id,value:o.id},{default:t(()=>[l(d(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),a(S,{span:12},{default:t(()=>[a(D,null,{default:t(()=>[a(C,{value:u.status,"onUpdate:value":e[1]||(e[1]=o=>u.status=o),placeholder:"所有状态","allow-clear":"",onChange:x},{default:t(()=>[a(m,{value:"InStock"},{default:t(()=>e[4]||(e[4]=[l("在库",-1)])),_:1,__:[4]}),a(m,{value:"LoanedOut"},{default:t(()=>e[5]||(e[5]=[l("借出",-1)])),_:1,__:[5]}),a(m,{value:"Disposed"},{default:t(()=>e[6]||(e[6]=[l("处置",-1)])),_:1,__:[6]})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),a(B,{value:c.value,"onUpdate:value":e[2]||(e[2]=o=>c.value=o),placeholder:"通过ID或名称搜索...",style:{"margin-top":"8px"}},null,8,["value"])]),a(P,{"data-source":N.value,loading:_.value,"item-layout":"vertical",class:"item-list"},{renderItem:t(({item:o})=>[(i(),y(E,{key:o.id},{default:t(()=>[a(A,{to:{name:"item-details",params:{id:o.id}}},{default:t(()=>[a(T,{hoverable:""},{title:t(()=>[n("span",oe,d(o.name),1)]),extra:t(()=>[a(F,{color:h(o.status).color},{default:t(()=>[l(d(h(o.status).text),1)]),_:2},1032,["color"])]),default:t(()=>[n("p",null,[e[7]||(e[7]=n("strong",null,"可视化ID:",-1)),l(" "+d(o.shortId),1)]),n("p",null,[e[8]||(e[8]=n("strong",null,"所在仓库:",-1)),l(" "+d(o.warehouseName),1)]),n("p",ae,[e[9]||(e[9]=n("strong",null,"UUID:",-1)),l(" "+d(o.id),1)])]),_:2},1024)]),_:2},1032,["to"])]),_:2},1024))]),empty:t(()=>[_.value?G("",!0):(i(),y(O,{key:0,description:"没有找到物品"},{default:t(()=>[a(M,{type:"primary",onClick:e[3]||(e[3]=o=>H(b).push("/inbound"))},{default:t(()=>e[10]||(e[10]=[l("立即入库",-1)])),_:1,__:[10]})]),_:1}))]),_:1},8,["data-source","loading"])])])}}}),ie=Y(se,[["__scopeId","data-v-54e0fa12"]]);export{ie as default};
