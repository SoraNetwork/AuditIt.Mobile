import{d as F,C as h,r as M,B as W,o as j,a as g,b as t,l as u,p as d,f as z,e as a,w as n,F as L,D as O,Q as R,E as k,i as m,n as T,k as $}from"./index-rdT5r4Nn.js";import{u as q}from"./warehouseStore-CE-A09F4.js";import{u as A}from"./itemStore-DEAKxtWs.js";import{u as G}from"./itemDefinitionStore-Dk_XAIR0.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"page-container"},K={class:"input-area"},P=F({__name:"Check",setup(X){const I=z(),p=q(),c=A(),f=G(),i=h({warehouseId:void 0}),_=M([]),w=W(()=>f.itemDefinitions.reduce((r,e)=>(r[e.id]=e,r),{}));j(()=>{p.fetchWarehouses(),f.fetchItemDefinitions()});const D=async()=>{if(!i.warehouseId){_.value=[];return}await c.fetchItems(i.warehouseId);const r=c.items.reduce((e,s)=>(e[s.itemDefinitionId]=(e[s.itemDefinitionId]||0)+1,e),{});_.value=Object.keys(r).map(e=>{const s=r[e];return h({itemDefinitionId:e,name:w.value[e]?.name||"未知物品",bookedQuantity:s,actualQuantity:s,get difference(){return this.actualQuantity-this.bookedQuantity}})})};return(r,e)=>{const s=a("a-page-header"),b=a("a-select-option"),S=a("a-select"),Q=a("a-form-item"),C=a("a-form"),v=a("a-statistic"),y=a("a-col"),x=a("a-row"),B=a("a-divider"),N=a("a-input-number"),U=a("a-card"),V=a("a-list-item"),E=a("a-list");return m(),g("div",null,[t(s,{title:"库存盘点",onBack:e[0]||(e[0]=o=>d(I).back())}),u("div",J,[t(C,{layout:"vertical",model:i},{default:n(()=>[t(Q,{label:"选择仓库"},{default:n(()=>[t(S,{value:i.warehouseId,"onUpdate:value":e[1]||(e[1]=o=>i.warehouseId=o),placeholder:"请选择仓库",onChange:D,"allow-clear":""},{default:n(()=>[(m(!0),g(L,null,O(d(p).warehouses,o=>(m(),T(b,{key:o.id,value:o.id},{default:n(()=>[$(k(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1},8,["model"]),t(E,{"data-source":_.value,loading:d(c).loading,"item-layout":"vertical"},{renderItem:n(({item:o})=>[t(V,null,{default:n(()=>[t(U,{title:o.name},{default:n(()=>[t(x,{gutter:16},{default:n(()=>[t(y,{span:12},{default:n(()=>[t(v,{title:"账面数量",value:o.bookedQuantity},null,8,["value"])]),_:2},1024),t(y,{span:12},{default:n(()=>[t(v,{title:"差异",value:o.difference},{formatter:n(({value:l})=>[u("span",{style:R({color:l!==0?"#ff4d4f":"#52c41a"})},k(l),5)]),_:2},1032,["value"])]),_:2},1024)]),_:2},1024),t(B,{style:{margin:"12px 0"}}),u("div",K,[e[2]||(e[2]=u("span",null,"实盘数量:",-1)),t(N,{value:o.actualQuantity,"onUpdate:value":l=>o.actualQuantity=l,min:0},null,8,["value","onUpdate:value"])])]),_:2},1032,["title"])]),_:2},1024)]),_:1},8,["data-source","loading"])])])}}}),oe=H(P,[["__scopeId","data-v-9744dfa3"]]);export{oe as default};
