import{d as P,r as V,h as z,B as E,o as O,a as p,b as h,k as R,p as f,g as T,e,f as o,m as g,w as s,l as i,E as n,j as c}from"./index-B7yYOxnO.js";import{u as j}from"./itemStore-C5UUQH6f.js";import{u as A}from"./auditLogStore-BE042JP3.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={class:"item-details-container"},U={key:1,class:"loading-container"},q={key:2,class:"content-wrapper"},G={class:"details-section"},H={class:"log-list-wrapper"},J=P({__name:"ItemDetails",setup(K){const k=z(),w=T(),v=j(),u=A(),d=V(!0),m=k.params.id,t=E(()=>v.items.find(a=>a.id===m));O(async()=>{d.value=!0,u.logs=[];try{const a=t.value?Promise.resolve():v.fetchItems({id:m}),r=u.fetchLogs({itemId:m});await Promise.all([a,r])}catch(a){console.error("Failed to load item details:",a)}finally{d.value=!1}});const y=a=>{switch(a){case"InStock":return"success";case"LoanedOut":return"warning";case"Disposed":return"error";default:return"default"}},I=a=>{switch(a){case"InStock":return"在库";case"LoanedOut":return"已借出";case"Disposed":return"已处置";default:return"未知"}};return(a,r)=>{const S=o("a-page-header"),b=o("a-spin"),l=o("a-descriptions-item"),D=o("a-badge"),L=o("a-descriptions"),x=o("a-list-item-meta"),B=o("a-list-item"),C=o("a-list"),N=o("a-empty");return c(),p("div",M,[t.value?(c(),h(S,{key:0,title:t.value.itemDefinition?.name,onBack:r[0]||(r[0]=()=>f(w).back())},null,8,["title"])):R("",!0),d.value?(c(),p("div",U,[e(b,{size:"large"})])):t.value?(c(),p("div",q,[g("div",G,[e(L,{bordered:"",column:1},{default:s(()=>[e(l,{label:"短ID"},{default:s(()=>[i(n(t.value.shortId),1)]),_:1}),e(l,{label:"状态"},{default:s(()=>[e(D,{status:y(t.value.status),text:I(t.value.status)},null,8,["status","text"])]),_:1}),e(l,{label:"仓库"},{default:s(()=>[i(n(t.value.warehouse?.name),1)]),_:1}),e(l,{label:"入库日期"},{default:s(()=>[i(n(new Date(t.value.entryDate).toLocaleString()),1)]),_:1}),e(l,{label:"最后更新"},{default:s(()=>[i(n(new Date(t.value.lastUpdated).toLocaleString()),1)]),_:1})]),_:1})]),g("div",H,[r[1]||(r[1]=g("h3",{class:"log-title"},"操作历史",-1)),e(C,{loading:f(u).loading,"data-source":f(u).logs,size:"small"},{renderItem:s(({item:_})=>[e(B,null,{default:s(()=>[e(x,null,{title:s(()=>[i(n(_.action)+" - by "+n(_.user),1)]),description:s(()=>[i(n(new Date(_.timestamp).toLocaleString()),1)]),_:2},1024)]),_:2},1024)]),_:1},8,["loading","data-source"])])])):(c(),h(N,{key:3}))])}}}),Z=F(J,[["__scopeId","data-v-0ac986af"]]);export{Z as default};
